<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document Converter</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <div class="container">
        <h1>Document Converter</h1>

        <div class="tab">
            <button class="tab-links active" onclick="openTab(event, 'imageTab')">Image Conversion</button>
            <button class="tab-links" onclick="openTab(event, 'pdfTab')">PDF Tools</button>
            <button class="tab-links" onclick="openTab(event, 'docTab')">Document Conversion</button>
        </div>

        <!-- Image Conversion Tab -->
        <div id="imageTab" class="tab-content" style="display: block;">
            <h2>Image Conversion</h2>
            <form action="/convert" method="post" enctype="multipart/form-data">
                <div class="file-upload">
                    <input type="file" id="image" name="image" accept="image/*" required>
                    <label for="image" class="file-upload-label">Select Image</label>
                    <p>Or drag and drop files here</p>
                    <div class="image-preview"></div>
                </div>

                <div class="conversion-selects">
                    <div class="input-format">
                        <label for="input_format">Input Format:</label>
                        <select id="input_format" name="input_format" required>
                            <option value="jpg">JPG/JPEG</option>
                            <option value="png">PNG</option>
                            <option value="webp">WebP</option>
                            <option value="gif">GIF</option>
                            <option value="bmp">BMP</option>
                            <option value="tiff">TIFF</option>
                        </select>
                    </div>

                    <div class="output-format">
                        <label for="output_format">Output Format:</label>
                        <select id="output_format" name="output_format" required>
                            <option value="jpg">JPG/JPEG</option>
                            <option value="png">PNG</option>
                            <option value="webp">WebP</option>
                            <option value="gif">GIF</option>
                            <option value="bmp">BMP</option>
                            <option value="tiff">TIFF</option>
                        </select>
                    </div>
                </div>

                <label for="quality">Quality (1-100):</label>
                <input type="number" id="quality" name="quality" min="1" max="100" value="80">

                <input type="submit" value="Convert Image">
            </form>
        </div>

        <!-- PDF Tools Tab -->
        <div id="pdfTab" class="tab-content">
            <h2>PDF Tools</h2>
            <form action="/pdf/convert" method="post" enctype="multipart/form-data">
                <div class="file-upload">
                    <input type="file" id="pdf_file" name="file" accept=".pdf,.jpg,.jpeg,.png" required>
                    <label for="pdf_file" class="file-upload-label">Select PDF File</label>
                    <p>Or drag and drop files here</p>
                </div>

                <label for="pdf_conversion">Operation:</label>
                <select id="pdf_conversion" name="conversion_type" onchange="showPdfOptions()" required>
                    <option value="">Select Operation</option>
                    <option value="pdf_to_images">PDF to Images</option>
                    <option value="images_to_pdf">Images to PDF</option>
                    <option value="compress_pdf">Compress PDF</option>
                    <option value="extract_text_from_pdf">Extract Text</option>
                    <option value="rotate_pdf_pages">Rotate Pages</option>
                    <option value="encrypt_pdf">Encrypt PDF</option>
                    <option value="decrypt_pdf">Decrypt PDF</option>
                </select>

                <!-- PDF to Images Options -->
                <div id="pdfToImagesOptions" class="hidden pdf-options">
                    <label for="dpi">DPI:</label>
                    <input type="number" id="dpi" name="dpi" min="72" max="600" value="300">

                    <label for="format">Output Format:</label>
                    <select id="format" name="format">
                        <option value="PNG">PNG</option>
                        <option value="JPEG">JPEG</option>
                        <option value="BMP">BMP</option>
                    </select>
                </div>

                <!-- Compress PDF Options -->
                <div id="compressPdfOptions" class="hidden pdf-options">
                    <label for="compress_quality">Quality:</label>
                    <select id="compress_quality" name="quality">
                        <option value="high">High</option>
                        <option value="medium" selected>Medium</option>
                        <option value="low">Low</option>
                    </select>
                </div>

                <!-- Rotate PDF Options -->
                <div id="rotatePdfOptions" class="hidden pdf-options">
                    <label for="rotation">Rotation Angle:</label>
                    <select id="rotation" name="rotation">
                        <option value="90">90° Clockwise</option>
                        <option value="180">180°</option>
                        <option value="270">90° Counter-clockwise</option>
                    </select>

                    <label for="pages">Pages (comma-separated, leave empty for all):</label>
                    <input type="text" id="pages" name="pages" placeholder="e.g., 1,3,5-7">
                </div>

                <!-- Encrypt PDF Options -->
                <div id="encryptPdfOptions" class="hidden pdf-options">
                    <label for="encrypt_password">User Password:</label>
                    <input type="password" id="encrypt_password" name="password" required>

                    <label for="owner_password">Owner Password (optional):</label>
                    <input type="password" id="owner_password" name="owner_password">
                </div>

                <!-- Decrypt PDF Options -->
                <div id="decryptPdfOptions" class="hidden pdf-options">
                    <label for="decrypt_password">Password:</label>
                    <input type="password" id="decrypt_password" name="password" required>
                </div>

                <input type="submit" value="Process PDF">
            </form>
        </div>

        <!-- Document Conversion Tab -->
        <div id="docTab" class="tab-content">
            <h2>Document Conversion</h2>
            <form action="/document/convert" method="post" enctype="multipart/form-data">
                <div class="file-upload">
                    <input type="file" id="doc_file" name="file" accept=".docx,.xlsx,.html,.txt,.pdf" required>
                    <label for="doc_file" class="file-upload-label">Select Document</label>
                    <p>Or drag and drop files here</p>
                </div>

                <label for="doc_conversion">Conversion Type:</label>
                <select id="doc_conversion" name="conversion_type" onchange="showDocOptions()" required>
                    <option value="">Select Conversion</option>
                    <option value="docx_to_pdf">DOCX to PDF</option>
                    <option value="html_to_pdf">HTML to PDF</option>
                    <option value="excel_to_pdf">Excel to PDF</option>
                    <option value="pdf_to_docx">PDF to DOCX</option>
                    <option value="create_csv_from_excel">Excel to CSV</option>
                    <option value="text_to_html">Text to HTML</option>
                    <option value="image_to_text">Image to Text (OCR)</option>
                </select>

                <!-- Excel Options -->
                <div id="excelOptions" class="hidden doc-options">
                    <label for="sheet_name">Sheet Name (optional):</label>
                    <input type="text" id="sheet_name" name="sheet_name" placeholder="Leave empty for first sheet">
                </div>

                <!-- HTML Options -->
                <div id="htmlOptions" class="hidden doc-options">
                    <label for="title">Document Title:</label>
                    <input type="text" id="title" name="title" value="Converted Document">
                </div>

                <input type="submit" value="Convert Document">
            </form>
        </div>
    </div>

    <script>
        function openTab(evt, tabName) {
            // Hide all tab content
            const tabContent = document.getElementsByClassName("tab-content");
            for (let i = 0; i < tabContent.length; i++) {
                tabContent[i].style.display = "none";
            }

            // Remove active class from all tab buttons
            const tabLinks = document.getElementsByClassName("tab-links");
            for (let i = 0; i < tabLinks.length; i++) {
                tabLinks[i].className = tabLinks[i].className.replace(" active", "");
            }

            // Show the selected tab and add active class to the button
            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.className += " active";
        }

        function showPdfOptions() {
            // Hide all PDF option divs
            const options = document.getElementsByClassName("pdf-options");
            for (let i = 0; i < options.length; i++) {
                options[i].classList.add("hidden");
            }

            // Show the selected option div
            const conversion = document.getElementById("pdf_conversion").value;
            if (conversion === "pdf_to_images") {
                document.getElementById("pdfToImagesOptions").classList.remove("hidden");
            } else if (conversion === "compress_pdf") {
                document.getElementById("compressPdfOptions").classList.remove("hidden");
            } else if (conversion === "rotate_pdf_pages") {
                document.getElementById("rotatePdfOptions").classList.remove("hidden");
            } else if (conversion === "encrypt_pdf") {
                document.getElementById("encryptPdfOptions").classList.remove("hidden");
            } else if (conversion === "decrypt_pdf") {
                document.getElementById("decryptPdfOptions").classList.remove("hidden");
            }
        }

        function showDocOptions() {
            // Hide all document option divs
            const options = document.getElementsByClassName("doc-options");
            for (let i = 0; i < options.length; i++) {
                options[i].classList.add("hidden");
            }

            // Show the selected option div
            const conversion = document.getElementById("doc_conversion").value;
            if (conversion === "excel_to_pdf" || conversion === "create_csv_from_excel") {
                document.getElementById("excelOptions").classList.remove("hidden");
            } else if (conversion === "text_to_html") {
                document.getElementById("htmlOptions").classList.remove("hidden");
            }
        }

        // Add image preview functionality
        document.addEventListener('DOMContentLoaded', function() {
            const fileInputs = document.querySelectorAll('input[type="file"]');

            fileInputs.forEach(input => {
                input.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file && file.type.match('image.*')) {
                        const reader = new FileReader();
                        const previewDiv = input.closest('.file-upload').querySelector('.image-preview');

                        if (!previewDiv) return;

                        reader.onload = function(e) {
                            previewDiv.innerHTML = `
                                <img src="${e.target.result}" alt="Preview">
                                <p>${file.name}</p>
                            `;
                        };

                        reader.readAsDataURL(file);
                    }
                });
            });
        });
    </script>
</body>
</html>